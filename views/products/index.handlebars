<h2>Productos</h2>

<p style="margin-bottom:20px;">
  ðŸ›’ Carrito de prueba:
  <a href="/carts/{{cartId}}">
    {{cartId}}
  </a>
</p>

<div style="display:flex; flex-wrap:wrap; gap:20px;">
  {{#each products}}
    <div style="
      border:1px solid #ccc;
      padding:15px;
      width:220px;
      border-radius:6px;
    ">

      {{#if thumbnails.length}}
        <img
          src="{{thumbnails.[0]}}"
          alt="{{title}}"
          style="width:100%; height:150px; object-fit:cover; margin-bottom:10px;"
        >
      {{/if}}

      <h3 style="margin:5px 0;">{{title}}</h3>

      <p style="font-size:14px;">{{description}}</p>
      <p><strong>CategorÃ­a:</strong> {{category}}</p>
      <p><strong>Precio:</strong> ${{price}}</p>

      <button
        onclick="addToCart('{{_id}}')"
        style="
          margin-top:10px;
          padding:8px;
          width:100%;
          cursor:pointer;
        "
      >
        Agregar al carrito
      </button>

    </div>
  {{/each}}
</div>

<script>
  const cartId = '{{cartId}}';

  async function addToCart(productId) {
    const res = await fetch(`/api/carts/${cartId}/product/${productId}`, {
      method: 'POST'
    });
    const data = await res.json();
    alert(data.message);
  }
</script>
